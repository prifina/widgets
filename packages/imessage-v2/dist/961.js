"use strict";(self.webpackChunk_prifina_widgets_imessage_v2=self.webpackChunk_prifina_widgets_imessage_v2||[]).push([[961],{5961:(e,t,n)=>{function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t),n.d(t,{Op:()=>Te,PrifinaContext:()=>Ae,PrifinaProvider:()=>xe,_fn:()=>Oe,buildFilter:()=>ye,usePrifina:()=>Se});var u=n(7900),l=n.n(u),p=function(e){if("object"!==s(e)||null===e||e instanceof Array)return console.log("WRONG OBJ TYPE ",s(e)),h(e);var t=Object.getOwnPropertySymbols(e),n=Object.keys(e);return t.length>0?"{"+t.map((function(t){return"symbol"===s(t)?'"'+t.toString()+'":'+h(e[t]):null})).filter((function(e){return e}))+"}":n.length>0?"{"+n.map((function(t){return"function"==typeof e[t]?null:'"'+t+'":'+h(e[t])})).filter((function(e){return e}))+"}":void 0},h=function e(t){switch(s(t)){case"string":return'"'+t.replace(/\\/g,"\\\\").replace('"','\\"')+'"';case"number":case"boolean":return""+t;case"function":return"null";case"symbol":return t.toString();case"object":return t instanceof Date?'"'+t.toISOString()+'"':t instanceof Array?"["+t.map(e).join(",")+"]":null===t?"null":p(t)}},d=function(){return Math.random().toString(36).slice(-10)},f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},f.apply(this,arguments)};function E(e,t){if(!Boolean(e))throw new Error(null!=t?t:"Unexpected invariant triggered.")}Object.create,Object.create;const T=/\r\n|[\n\r]/g;function m(e,t){let n=0,r=1;for(const i of e.body.matchAll(T)){if("number"==typeof i.index||E(!1),i.index>=t)break;n=i.index+i[0].length,r+=1}return{line:r,column:t+1-n}}function I(e,t){const n=e.locationOffset.column-1,r="".padStart(n)+e.body,i=t.line-1,s=e.locationOffset.line-1,o=t.line+s,a=1===t.line?n:0,c=t.column+a,u=`${e.name}:${o}:${c}\n`,l=r.split(/\r\n|[\n\r]/g),p=l[i];if(p.length>120){const e=Math.floor(c/80),t=c%80,n=[];for(let e=0;e<p.length;e+=80)n.push(p.slice(e,e+80));return u+N([[`${o} |`,n[0]],...n.slice(1,e+1).map((e=>["|",e])),["|","^".padStart(t)],["|",n[e+1]]])}return u+N([[o-1+" |",l[i-1]],[`${o} |`,p],["|","^".padStart(c)],[`${o+1} |`,l[i+1]]])}function N(e){const t=e.filter((([e,t])=>void 0!==t)),n=Math.max(...t.map((([e])=>e.length)));return t.map((([e,t])=>e.padStart(n)+(t?" "+t:""))).join("\n")}class O extends Error{constructor(e,...t){var n,r,i;const{nodes:s,source:o,positions:a,path:c,originalError:u,extensions:l}=function(e){const t=e[0];return null==t||"kind"in t||"length"in t?{nodes:t,source:e[1],positions:e[2],path:e[3],originalError:e[4],extensions:e[5]}:t}(t);super(e),this.name="GraphQLError",this.path=null!=c?c:void 0,this.originalError=null!=u?u:void 0,this.nodes=y(Array.isArray(s)?s:s?[s]:void 0);const p=y(null===(n=this.nodes)||void 0===n?void 0:n.map((e=>e.loc)).filter((e=>null!=e)));this.source=null!=o?o:null==p||null===(r=p[0])||void 0===r?void 0:r.source,this.positions=null!=a?a:null==p?void 0:p.map((e=>e.start)),this.locations=a&&o?a.map((e=>m(o,e))):null==p?void 0:p.map((e=>m(e.source,e.start)));const h=function(e){return"object"==typeof e&&null!==e}(null==u?void 0:u.extensions)?null==u?void 0:u.extensions:void 0;this.extensions=null!==(i=null!=l?l:h)&&void 0!==i?i:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=u&&u.stack?Object.defineProperty(this,"stack",{value:u.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,O):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let e=this.message;if(this.nodes)for(const n of this.nodes)n.loc&&(e+="\n\n"+I((t=n.loc).source,m(t.source,t.start)));else if(this.source&&this.locations)for(const t of this.locations)e+="\n\n"+I(this.source,t);var t;return e}toJSON(){const e={message:this.message};return null!=this.locations&&(e.locations=this.locations),null!=this.path&&(e.path=this.path),null!=this.extensions&&Object.keys(this.extensions).length>0&&(e.extensions=this.extensions),e}}function y(e){return void 0===e||0===e.length?void 0:e}function v(e,t,n){return new O(`Syntax Error: ${n}`,{source:e,positions:[t]})}class b{constructor(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class g{constructor(e,t,n,r,i,s){this.kind=e,this.start=t,this.end=n,this.line=r,this.column=i,this.value=s,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}var A,x,S,_,D;function k(e){return e>=48&&e<=57}function C(e){return e>=97&&e<=122||e>=65&&e<=90}function R(e){return C(e)||95===e}function L(e){var t;let n=Number.MAX_SAFE_INTEGER,r=null,i=-1;for(let t=0;t<e.length;++t){var s;const o=e[t],a=w(o);a!==o.length&&(r=null!==(s=r)&&void 0!==s?s:t,i=t,0!==t&&a<n&&(n=a))}return e.map(((e,t)=>0===t?e:e.slice(n))).slice(null!==(t=r)&&void 0!==t?t:0,i+1)}function w(e){let t=0;for(;t<e.length&&(9===(n=e.charCodeAt(t))||32===n);)++t;var n;return t}new Set(Object.keys({Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]})),function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"}(A||(A={})),function(e){e.QUERY="QUERY",e.MUTATION="MUTATION",e.SUBSCRIPTION="SUBSCRIPTION",e.FIELD="FIELD",e.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",e.FRAGMENT_SPREAD="FRAGMENT_SPREAD",e.INLINE_FRAGMENT="INLINE_FRAGMENT",e.VARIABLE_DEFINITION="VARIABLE_DEFINITION",e.SCHEMA="SCHEMA",e.SCALAR="SCALAR",e.OBJECT="OBJECT",e.FIELD_DEFINITION="FIELD_DEFINITION",e.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",e.INTERFACE="INTERFACE",e.UNION="UNION",e.ENUM="ENUM",e.ENUM_VALUE="ENUM_VALUE",e.INPUT_OBJECT="INPUT_OBJECT",e.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"}(x||(x={})),function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"}(S||(S={})),(D=_||(_={})).SOF="<SOF>",D.EOF="<EOF>",D.BANG="!",D.DOLLAR="$",D.AMP="&",D.PAREN_L="(",D.PAREN_R=")",D.SPREAD="...",D.COLON=":",D.EQUALS="=",D.AT="@",D.BRACKET_L="[",D.BRACKET_R="]",D.BRACE_L="{",D.PIPE="|",D.BRACE_R="}",D.NAME="Name",D.INT="Int",D.FLOAT="Float",D.STRING="String",D.BLOCK_STRING="BlockString",D.COMMENT="Comment";class F{constructor(e){const t=new g(_.SOF,0,0,0,0);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let e=this.token;if(e.kind!==_.EOF)do{if(e.next)e=e.next;else{const t=G(this,e.end);e.next=t,t.prev=e,e=t}}while(e.kind===_.COMMENT);return e}}function P(e){return e>=0&&e<=55295||e>=57344&&e<=1114111}function U(e,t){return M(e.charCodeAt(t))&&j(e.charCodeAt(t+1))}function M(e){return e>=55296&&e<=56319}function j(e){return e>=56320&&e<=57343}function B(e,t){const n=e.source.body.codePointAt(t);if(void 0===n)return _.EOF;if(n>=32&&n<=126){const e=String.fromCodePoint(n);return'"'===e?"'\"'":`"${e}"`}return"U+"+n.toString(16).toUpperCase().padStart(4,"0")}function V(e,t,n,r,i){const s=e.line,o=1+n-e.lineStart;return new g(t,n,r,s,o,i)}function G(e,t){const n=e.source.body,r=n.length;let i=t;for(;i<r;){const t=n.charCodeAt(i);switch(t){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++e.line,e.lineStart=i;continue;case 13:10===n.charCodeAt(i+1)?i+=2:++i,++e.line,e.lineStart=i;continue;case 35:return K(e,i);case 33:return V(e,_.BANG,i,i+1);case 36:return V(e,_.DOLLAR,i,i+1);case 38:return V(e,_.AMP,i,i+1);case 40:return V(e,_.PAREN_L,i,i+1);case 41:return V(e,_.PAREN_R,i,i+1);case 46:if(46===n.charCodeAt(i+1)&&46===n.charCodeAt(i+2))return V(e,_.SPREAD,i,i+3);break;case 58:return V(e,_.COLON,i,i+1);case 61:return V(e,_.EQUALS,i,i+1);case 64:return V(e,_.AT,i,i+1);case 91:return V(e,_.BRACKET_L,i,i+1);case 93:return V(e,_.BRACKET_R,i,i+1);case 123:return V(e,_.BRACE_L,i,i+1);case 124:return V(e,_.PIPE,i,i+1);case 125:return V(e,_.BRACE_R,i,i+1);case 34:return 34===n.charCodeAt(i+1)&&34===n.charCodeAt(i+2)?W(e,i):J(e,i)}if(k(t)||45===t)return Y(e,i,t);if(R(t))return Z(e,i);throw v(e.source,i,39===t?"Unexpected single quote character ('), did you mean to use a double quote (\")?":P(t)||U(n,i)?`Unexpected character: ${B(e,i)}.`:`Invalid character: ${B(e,i)}.`)}return V(e,_.EOF,r,r)}function K(e,t){const n=e.source.body,r=n.length;let i=t+1;for(;i<r;){const e=n.charCodeAt(i);if(10===e||13===e)break;if(P(e))++i;else{if(!U(n,i))break;i+=2}}return V(e,_.COMMENT,t,i,n.slice(t+1,i))}function Y(e,t,n){const r=e.source.body;let i=t,s=n,o=!1;if(45===s&&(s=r.charCodeAt(++i)),48===s){if(s=r.charCodeAt(++i),k(s))throw v(e.source,i,`Invalid number, unexpected digit after 0: ${B(e,i)}.`)}else i=$(e,i,s),s=r.charCodeAt(i);if(46===s&&(o=!0,s=r.charCodeAt(++i),i=$(e,i,s),s=r.charCodeAt(i)),69!==s&&101!==s||(o=!0,s=r.charCodeAt(++i),43!==s&&45!==s||(s=r.charCodeAt(++i)),i=$(e,i,s),s=r.charCodeAt(i)),46===s||R(s))throw v(e.source,i,`Invalid number, expected digit but got: ${B(e,i)}.`);return V(e,o?_.FLOAT:_.INT,t,i,r.slice(t,i))}function $(e,t,n){if(!k(n))throw v(e.source,t,`Invalid number, expected digit but got: ${B(e,t)}.`);const r=e.source.body;let i=t+1;for(;k(r.charCodeAt(i));)++i;return i}function J(e,t){const n=e.source.body,r=n.length;let i=t+1,s=i,o="";for(;i<r;){const r=n.charCodeAt(i);if(34===r)return o+=n.slice(s,i),V(e,_.STRING,t,i+1,o);if(92!==r){if(10===r||13===r)break;if(P(r))++i;else{if(!U(n,i))throw v(e.source,i,`Invalid character within String: ${B(e,i)}.`);i+=2}}else{o+=n.slice(s,i);const t=117===n.charCodeAt(i+1)?123===n.charCodeAt(i+2)?q(e,i):X(e,i):z(e,i);o+=t.value,i+=t.size,s=i}}throw v(e.source,i,"Unterminated string.")}function q(e,t){const n=e.source.body;let r=0,i=3;for(;i<12;){const e=n.charCodeAt(t+i++);if(125===e){if(i<5||!P(r))break;return{value:String.fromCodePoint(r),size:i}}if(r=r<<4|Q(e),r<0)break}throw v(e.source,t,`Invalid Unicode escape sequence: "${n.slice(t,t+i)}".`)}function X(e,t){const n=e.source.body,r=H(n,t+2);if(P(r))return{value:String.fromCodePoint(r),size:6};if(M(r)&&92===n.charCodeAt(t+6)&&117===n.charCodeAt(t+7)){const e=H(n,t+8);if(j(e))return{value:String.fromCodePoint(r,e),size:12}}throw v(e.source,t,`Invalid Unicode escape sequence: "${n.slice(t,t+6)}".`)}function H(e,t){return Q(e.charCodeAt(t))<<12|Q(e.charCodeAt(t+1))<<8|Q(e.charCodeAt(t+2))<<4|Q(e.charCodeAt(t+3))}function Q(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function z(e,t){const n=e.source.body;switch(n.charCodeAt(t+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:"\n",size:2};case 114:return{value:"\r",size:2};case 116:return{value:"\t",size:2}}throw v(e.source,t,`Invalid character escape sequence: "${n.slice(t,t+2)}".`)}function W(e,t){const n=e.source.body,r=n.length;let i=e.lineStart,s=t+3,o=s,a="";const c=[];for(;s<r;){const r=n.charCodeAt(s);if(34===r&&34===n.charCodeAt(s+1)&&34===n.charCodeAt(s+2)){a+=n.slice(o,s),c.push(a);const r=V(e,_.BLOCK_STRING,t,s+3,L(c).join("\n"));return e.line+=c.length-1,e.lineStart=i,r}if(92!==r||34!==n.charCodeAt(s+1)||34!==n.charCodeAt(s+2)||34!==n.charCodeAt(s+3))if(10!==r&&13!==r)if(P(r))++s;else{if(!U(n,s))throw v(e.source,s,`Invalid character within String: ${B(e,s)}.`);s+=2}else a+=n.slice(o,s),c.push(a),13===r&&10===n.charCodeAt(s+1)?s+=2:++s,a="",o=s,i=s;else a+=n.slice(o,s),o=s+1,s+=4}throw v(e.source,s,"Unterminated string.")}function Z(e,t){const n=e.source.body,r=n.length;let i=t+1;for(;i<r&&(C(s=n.charCodeAt(i))||k(s)||95===s);)++i;var s;return V(e,_.NAME,t,i,n.slice(t,i))}function ee(e,t){if(!Boolean(e))throw new Error(t)}function te(e,t){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return function(e,t){if(null===e)return"null";if(t.includes(e))return"[Circular]";const n=[...t,e];if(function(e){return"function"==typeof e.toJSON}(e)){const t=e.toJSON();if(t!==e)return"string"==typeof t?t:te(t,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";const n=Math.min(10,e.length),r=e.length-n,i=[];for(let r=0;r<n;++r)i.push(te(e[r],t));return 1===r?i.push("... 1 more item"):r>1&&i.push(`... ${r} more items`),"["+i.join(", ")+"]"}(e,n);return function(e,t){const n=Object.entries(e);if(0===n.length)return"{}";if(t.length>2)return"["+function(e){const t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){const t=e.constructor.name;if("string"==typeof t&&""!==t)return t}return t}(e)+"]";const r=n.map((([e,n])=>e+": "+te(n,t)));return"{ "+r.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}class ne{constructor(e,t="GraphQL request",n={line:1,column:1}){"string"==typeof e||ee(!1,`Body must be a string. Received: ${function(e){return te(e,[])}(e)}.`),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||ee(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||ee(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}class re{constructor(e,t={}){const n=function(e){return function(e,t){return e instanceof t}(e,ne)}(e)?e:new ne(e);this._lexer=new F(n),this._options=t,this._tokenCounter=0}parseName(){const e=this.expectToken(_.NAME);return this.node(e,{kind:S.NAME,value:e.value})}parseDocument(){return this.node(this._lexer.token,{kind:S.DOCUMENT,definitions:this.many(_.SOF,this.parseDefinition,_.EOF)})}parseDefinition(){if(this.peek(_.BRACE_L))return this.parseOperationDefinition();const e=this.peekDescription(),t=e?this._lexer.lookahead():this._lexer.token;if(t.kind===_.NAME){switch(t.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(e)throw v(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(t.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(t)}parseOperationDefinition(){const e=this._lexer.token;if(this.peek(_.BRACE_L))return this.node(e,{kind:S.OPERATION_DEFINITION,operation:A.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const t=this.parseOperationType();let n;return this.peek(_.NAME)&&(n=this.parseName()),this.node(e,{kind:S.OPERATION_DEFINITION,operation:t,name:n,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const e=this.expectToken(_.NAME);switch(e.value){case"query":return A.QUERY;case"mutation":return A.MUTATION;case"subscription":return A.SUBSCRIPTION}throw this.unexpected(e)}parseVariableDefinitions(){return this.optionalMany(_.PAREN_L,this.parseVariableDefinition,_.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:S.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(_.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(_.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const e=this._lexer.token;return this.expectToken(_.DOLLAR),this.node(e,{kind:S.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:S.SELECTION_SET,selections:this.many(_.BRACE_L,this.parseSelection,_.BRACE_R)})}parseSelection(){return this.peek(_.SPREAD)?this.parseFragment():this.parseField()}parseField(){const e=this._lexer.token,t=this.parseName();let n,r;return this.expectOptionalToken(_.COLON)?(n=t,r=this.parseName()):r=t,this.node(e,{kind:S.FIELD,alias:n,name:r,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(_.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(e){const t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(_.PAREN_L,t,_.PAREN_R)}parseArgument(e=!1){const t=this._lexer.token,n=this.parseName();return this.expectToken(_.COLON),this.node(t,{kind:S.ARGUMENT,name:n,value:this.parseValueLiteral(e)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const e=this._lexer.token;this.expectToken(_.SPREAD);const t=this.expectOptionalKeyword("on");return!t&&this.peek(_.NAME)?this.node(e,{kind:S.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(e,{kind:S.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const e=this._lexer.token;return this.expectKeyword("fragment"),!0===this._options.allowLegacyFragmentVariables?this.node(e,{kind:S.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(e,{kind:S.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()}parseValueLiteral(e){const t=this._lexer.token;switch(t.kind){case _.BRACKET_L:return this.parseList(e);case _.BRACE_L:return this.parseObject(e);case _.INT:return this.advanceLexer(),this.node(t,{kind:S.INT,value:t.value});case _.FLOAT:return this.advanceLexer(),this.node(t,{kind:S.FLOAT,value:t.value});case _.STRING:case _.BLOCK_STRING:return this.parseStringLiteral();case _.NAME:switch(this.advanceLexer(),t.value){case"true":return this.node(t,{kind:S.BOOLEAN,value:!0});case"false":return this.node(t,{kind:S.BOOLEAN,value:!1});case"null":return this.node(t,{kind:S.NULL});default:return this.node(t,{kind:S.ENUM,value:t.value})}case _.DOLLAR:if(e){if(this.expectToken(_.DOLLAR),this._lexer.token.kind===_.NAME){const e=this._lexer.token.value;throw v(this._lexer.source,t.start,`Unexpected variable "$${e}" in constant value.`)}throw this.unexpected(t)}return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const e=this._lexer.token;return this.advanceLexer(),this.node(e,{kind:S.STRING,value:e.value,block:e.kind===_.BLOCK_STRING})}parseList(e){return this.node(this._lexer.token,{kind:S.LIST,values:this.any(_.BRACKET_L,(()=>this.parseValueLiteral(e)),_.BRACKET_R)})}parseObject(e){return this.node(this._lexer.token,{kind:S.OBJECT,fields:this.any(_.BRACE_L,(()=>this.parseObjectField(e)),_.BRACE_R)})}parseObjectField(e){const t=this._lexer.token,n=this.parseName();return this.expectToken(_.COLON),this.node(t,{kind:S.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e)})}parseDirectives(e){const t=[];for(;this.peek(_.AT);)t.push(this.parseDirective(e));return t}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(e){const t=this._lexer.token;return this.expectToken(_.AT),this.node(t,{kind:S.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e)})}parseTypeReference(){const e=this._lexer.token;let t;if(this.expectOptionalToken(_.BRACKET_L)){const n=this.parseTypeReference();this.expectToken(_.BRACKET_R),t=this.node(e,{kind:S.LIST_TYPE,type:n})}else t=this.parseNamedType();return this.expectOptionalToken(_.BANG)?this.node(e,{kind:S.NON_NULL_TYPE,type:t}):t}parseNamedType(){return this.node(this._lexer.token,{kind:S.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(_.STRING)||this.peek(_.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");const n=this.parseConstDirectives(),r=this.many(_.BRACE_L,this.parseOperationTypeDefinition,_.BRACE_R);return this.node(e,{kind:S.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:r})}parseOperationTypeDefinition(){const e=this._lexer.token,t=this.parseOperationType();this.expectToken(_.COLON);const n=this.parseNamedType();return this.node(e,{kind:S.OPERATION_TYPE_DEFINITION,operation:t,type:n})}parseScalarTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");const n=this.parseName(),r=this.parseConstDirectives();return this.node(e,{kind:S.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:r})}parseObjectTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");const n=this.parseName(),r=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();return this.node(e,{kind:S.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:i,fields:s})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(_.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(_.BRACE_L,this.parseFieldDefinition,_.BRACE_R)}parseFieldDefinition(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseArgumentDefs();this.expectToken(_.COLON);const i=this.parseTypeReference(),s=this.parseConstDirectives();return this.node(e,{kind:S.FIELD_DEFINITION,description:t,name:n,arguments:r,type:i,directives:s})}parseArgumentDefs(){return this.optionalMany(_.PAREN_L,this.parseInputValueDef,_.PAREN_R)}parseInputValueDef(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(_.COLON);const r=this.parseTypeReference();let i;this.expectOptionalToken(_.EQUALS)&&(i=this.parseConstValueLiteral());const s=this.parseConstDirectives();return this.node(e,{kind:S.INPUT_VALUE_DEFINITION,description:t,name:n,type:r,defaultValue:i,directives:s})}parseInterfaceTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");const n=this.parseName(),r=this.parseImplementsInterfaces(),i=this.parseConstDirectives(),s=this.parseFieldsDefinition();return this.node(e,{kind:S.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:i,fields:s})}parseUnionTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");const n=this.parseName(),r=this.parseConstDirectives(),i=this.parseUnionMemberTypes();return this.node(e,{kind:S.UNION_TYPE_DEFINITION,description:t,name:n,directives:r,types:i})}parseUnionMemberTypes(){return this.expectOptionalToken(_.EQUALS)?this.delimitedMany(_.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");const n=this.parseName(),r=this.parseConstDirectives(),i=this.parseEnumValuesDefinition();return this.node(e,{kind:S.ENUM_TYPE_DEFINITION,description:t,name:n,directives:r,values:i})}parseEnumValuesDefinition(){return this.optionalMany(_.BRACE_L,this.parseEnumValueDefinition,_.BRACE_R)}parseEnumValueDefinition(){const e=this._lexer.token,t=this.parseDescription(),n=this.parseEnumValueName(),r=this.parseConstDirectives();return this.node(e,{kind:S.ENUM_VALUE_DEFINITION,description:t,name:n,directives:r})}parseEnumValueName(){if("true"===this._lexer.token.value||"false"===this._lexer.token.value||"null"===this._lexer.token.value)throw v(this._lexer.source,this._lexer.token.start,`${ie(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");const n=this.parseName(),r=this.parseConstDirectives(),i=this.parseInputFieldsDefinition();return this.node(e,{kind:S.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:r,fields:i})}parseInputFieldsDefinition(){return this.optionalMany(_.BRACE_L,this.parseInputValueDef,_.BRACE_R)}parseTypeSystemExtension(){const e=this._lexer.lookahead();if(e.kind===_.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)}parseSchemaExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const t=this.parseConstDirectives(),n=this.optionalMany(_.BRACE_L,this.parseOperationTypeDefinition,_.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return this.node(e,{kind:S.SCHEMA_EXTENSION,directives:t,operationTypes:n})}parseScalarTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const t=this.parseName(),n=this.parseConstDirectives();if(0===n.length)throw this.unexpected();return this.node(e,{kind:S.SCALAR_TYPE_EXTENSION,name:t,directives:n})}parseObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseConstDirectives(),i=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:S.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:i})}parseInterfaceTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseConstDirectives(),i=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===i.length)throw this.unexpected();return this.node(e,{kind:S.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:i})}parseUnionTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const t=this.parseName(),n=this.parseConstDirectives(),r=this.parseUnionMemberTypes();if(0===n.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:S.UNION_TYPE_EXTENSION,name:t,directives:n,types:r})}parseEnumTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const t=this.parseName(),n=this.parseConstDirectives(),r=this.parseEnumValuesDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:S.ENUM_TYPE_EXTENSION,name:t,directives:n,values:r})}parseInputObjectTypeExtension(){const e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const t=this.parseName(),n=this.parseConstDirectives(),r=this.parseInputFieldsDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return this.node(e,{kind:S.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:r})}parseDirectiveDefinition(){const e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(_.AT);const n=this.parseName(),r=this.parseArgumentDefs(),i=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const s=this.parseDirectiveLocations();return this.node(e,{kind:S.DIRECTIVE_DEFINITION,description:t,name:n,arguments:r,repeatable:i,locations:s})}parseDirectiveLocations(){return this.delimitedMany(_.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const e=this._lexer.token,t=this.parseName();if(Object.prototype.hasOwnProperty.call(x,t.value))return t;throw this.unexpected(e)}node(e,t){return!0!==this._options.noLocation&&(t.loc=new b(e,this._lexer.lastToken,this._lexer.source)),t}peek(e){return this._lexer.token.kind===e}expectToken(e){const t=this._lexer.token;if(t.kind===e)return this.advanceLexer(),t;throw v(this._lexer.source,t.start,`Expected ${se(e)}, found ${ie(t)}.`)}expectOptionalToken(e){return this._lexer.token.kind===e&&(this.advanceLexer(),!0)}expectKeyword(e){const t=this._lexer.token;if(t.kind!==_.NAME||t.value!==e)throw v(this._lexer.source,t.start,`Expected "${e}", found ${ie(t)}.`);this.advanceLexer()}expectOptionalKeyword(e){const t=this._lexer.token;return t.kind===_.NAME&&t.value===e&&(this.advanceLexer(),!0)}unexpected(e){const t=null!=e?e:this._lexer.token;return v(this._lexer.source,t.start,`Unexpected ${ie(t)}.`)}any(e,t,n){this.expectToken(e);const r=[];for(;!this.expectOptionalToken(n);)r.push(t.call(this));return r}optionalMany(e,t,n){if(this.expectOptionalToken(e)){const e=[];do{e.push(t.call(this))}while(!this.expectOptionalToken(n));return e}return[]}many(e,t,n){this.expectToken(e);const r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r}delimitedMany(e,t){this.expectOptionalToken(e);const n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n}advanceLexer(){const{maxTokens:e}=this._options,t=this._lexer.advance();if(void 0!==e&&t.kind!==_.EOF&&(++this._tokenCounter,this._tokenCounter>e))throw v(this._lexer.source,t.start,`Document contains more that ${e} tokens. Parsing aborted.`)}}function ie(e){const t=e.value;return se(e.kind)+(null!=t?` "${t}"`:"")}function se(e){return function(e){return e===_.BANG||e===_.DOLLAR||e===_.AMP||e===_.PAREN_L||e===_.PAREN_R||e===_.SPREAD||e===_.COLON||e===_.EQUALS||e===_.AT||e===_.BRACKET_L||e===_.BRACKET_R||e===_.BRACE_L||e===_.PIPE||e===_.BRACE_R}(e)?`"${e}"`:e}var oe=new Map,ae=new Map,ce=!0,ue=!1;function le(e){return e.replace(/[\s,]+/g," ").trim()}function pe(e){var t,n,r,i=le(e);if(!oe.has(i)){var s=function(e,t){return new re(e,t).parseDocument()}(e,{experimentalFragmentVariables:ue,allowLegacyFragmentVariables:ue});if(!s||"Document"!==s.kind)throw new Error("Not a valid GraphQL document.");oe.set(i,function(e){var t=new Set(e.definitions);t.forEach((function(e){e.loc&&delete e.loc,Object.keys(e).forEach((function(n){var r=e[n];r&&"object"==typeof r&&t.add(r)}))}));var n=e.loc;return n&&(delete n.startToken,delete n.endToken),e}((t=s,n=new Set,r=[],t.definitions.forEach((function(e){if("FragmentDefinition"===e.kind){var t=e.name.value,i=le((o=e.loc).source.body.substring(o.start,o.end)),s=ae.get(t);s&&!s.has(i)?ce&&console.warn("Warning: fragment with name "+t+" already exists.\ngraphql-tag enforces all fragment names across your application to be unique; read more about\nthis in the docs: http://dev.apollodata.com/core/fragments.html#unique-names"):s||ae.set(t,s=new Set),s.add(i),n.has(i)||(n.add(i),r.push(e))}else r.push(e);var o})),f(f({},t),{definitions:r}))))}return oe.get(i)}function he(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"string"==typeof e&&(e=[e]);var r=e[0];return t.forEach((function(t,n){t&&"Document"===t.kind?r+=t.loc.source.body:r+=t,r+=e[n+1]})),pe(r)}var de,fe=he;(de=he||(he={})).gql=fe,de.resetCaches=function(){oe.clear(),ae.clear()},de.disableFragmentWarnings=function(){ce=!1},de.enableExperimentalFragmentVariables=function(){ue=!0},de.disableExperimentalFragmentVariables=function(){ue=!1},he.default=he;const Ee=he;var Te={eq:Symbol.for("="),ne:Symbol.for("!="),gte:Symbol.for(">="),gt:Symbol.for(">"),lte:Symbol.for("<="),lt:Symbol.for("<"),and:Symbol.for(" and "),or:Symbol.for(" or "),not:Symbol.for(" not "),like:Symbol.for(" like "),in:Symbol.for(" in "),between:Symbol.for(" between ")};function me(e,t,n){if(console.log("CHECK ",n),[Te.in,Te.between].indexOf(t)>-1)e+=Symbol.keyFor(t),Te.in===t&&(e+="("+n+")"),Te.between===t&&(e+=n[0]+" and "+n[1]);else if(null===n)if(Te.eq===t)e+=" IS NULL";else{if(Te.ne!==t)throw new Error("ONLY eq,ne allowed with null");e+=" IS NOT NULL"}else e+=Symbol.keyFor(t)+n;return e}var Ie=["bool","int","integer","string","float","decimal","numeric","timestamp"],Ne=["year","month","day","hour","minute","second","timezone_hour","timezone_minute"];function Oe(e,t,n){if("CAST"===e){if("string"!=typeof n||-1===Ie.indexOf(n))throw new Error("Datatype error, only (",Ie.join(",")+") allowed");return"CAST(".concat(t," as ").concat(n,")")}if("CHAR_LENGTH"===e||"CHARACTER_LENGTH"===e||"UPPER"===e||"LOWER"===e)return"".concat(e,"(").concat(t,")");if("TRIM"===e){var r="BOTH";if(void 0===n||"string"==typeof n&&-1!==["LEADING","TRAILING"].indexOf(n))return void 0!==n&&(r=n),"".concat(e,"(").concat(r," FROM ").concat(t,")");throw new Error("Trim option error, only (LEADING,TRAILING or BOTH) allowed ")}if("SUBSTRING"===e){if("object"!==s(n)||0===n.length)throw new Error("Substring option error, [start, length]");return 2===n.length?"".concat(e,"(").concat(t," ,").concat(n[0],",").concat(n[1],")"):"".concat(e,"(").concat(t," ,").concat(n[0],")")}if(["AVG","MAX","MIN","SUM","COUNT"].indexOf(e)>-1)return"".concat(e,"(").concat(t,")");if("UTCNOW"===e)return"".concat(e,"()");if(["TO_TIMESTAMP"].indexOf(e)>-1)return"".concat(e,"(").concat(t,")");if("DATE_ADD"===e){if("object"!==s(n)||2!=n.length)throw new Error("DATE_ADD option error, [date_part, value]");return"".concat(e,"(").concat(n[0],",").concat(n[1],", ").concat(t,")")}if("DATE_DIFF"===e){if("object"!==s(n)||2!=n.length)throw new Error("DATE_DIFF option error, [date_part, timestamp]");return"".concat(e,"(").concat(n[0],", ").concat(t,", ").concat(n[1],")")}if("TO_STRING"===e){if(void 0!==n&&"string"!=typeof n)throw new Error("TO_STRING option error, time format pattern is missing");return"".concat(e,"(").concat(t," ,").concat(n,")")}if("EXTRACT"===e){if(void 0!==n&&"string"!=typeof n&&-1===Ne.indexOf(n))throw new Error("EXTRACT option error, date part value is missing or invalid");return"".concat(e,"(").concat(n," FROM ").concat(t,")")}return"YEAR"===e?"EXTRACT(year from TO_TIMESTAMP(".concat(t,"))"):"MONTH"===e?"EXTRACT(month from TO_TIMESTAMP(".concat(t,"))"):"DAY"===e?"EXTRACT(day from TO_TIMESTAMP(".concat(t,"))"):"HOUR"===e?"EXTRACT(hour from TO_TIMESTAMP(".concat(t,"))"):void 0}function ye(e){var t="",n=Object.getOwnPropertySymbols(e);if(n.length>0){var r=n[0];Object.keys(e[r]).forEach((function(n,i){Object.getOwnPropertySymbols(e[r][n]).forEach((function(s,o){t=me(t+=i>0?Symbol.keyFor(r)+n:n,s,e[r][n][s])}))}))}else Object.keys(e).forEach((function(n){t+=n,Object.getOwnPropertySymbols(e[n]).forEach((function(r,i){if([Te.and,Te.or,Te.not].indexOf(r)>-1){var s=r;Object.getOwnPropertySymbols(e[n][r]).forEach((function(i,o){o>0&&(t+=Symbol.keyFor(s)+n),t=me(t,i,e[n][r][i])}))}else{if(i>0)throw new Error("Logical opertor error");t=me(t,r,e[n][r])}}))}));return t}function ve(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},n=Object.getOwnPropertySymbols(e);return n.length>0?n.forEach((function(n){var r=Symbol.keyFor(n).trim();t[r]={},Object.keys(e[n]).forEach((function(i,s){t[r][[i]]={},Object.getOwnPropertySymbols(e[n][i]).forEach((function(o,a){t[r][[i]][[Symbol.keyFor(o).trim()]]=e[n][i][o],console.log("II ",s)}))}))})):Object.keys(e).length>0&&Object.keys(e).forEach((function(n,r){t[[n]]={},Object.getOwnPropertySymbols(e[n]).forEach((function(r,i){t[n][[Symbol.keyFor(r).trim()]]=e[n][r],console.log("ONE COND ",i)}))})),JSON.stringify(t)}var be=["activeApp","activeUser","Context","stage","children"],ge=["appHandler"],Ae=(0,u.createContext)({}),xe=function(e){var t,n,r=e.activeApp,h=e.activeUser,f=e.Context,E=e.stage,T=void 0===E?"dev":E,m=e.children,I=a(e,be),N=(0,u.useRef)(i({stage:T},I)),O=(0,u.useRef)({}),y=(0,u.useRef)({}),v=(0,u.useRef)({}),b=(0,u.useRef)({}),g=(t=(0,u.useState)(h||{name:"Test",uuid:"Testing-uuid",endpoint:"https://endpoint.xxx",region:"us-east-1"}),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw i}}return s}}(t,n)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),A=g[0];g[1];var x=(0,u.useCallback)((function(){return console.log("Prifina current",N.current),{init:N.current.init,callbacks:w(),API:U()}}),[]),S=function(e){var t,n;if(console.log("SUBSCRIPTION OPTS ",e),null!==(t=O.current)&&void 0!==t&&t.sandbox){var r=Object.assign({},e);O.current.sandbox[0](o({},r.name,r))}return null!==(n=O.current)&&void 0!==n&&n.sandbox&&O.current.sandbox[0]({mutationRequest:{appID:e.appId,variables:e.variables}}),new Promise((function(t,n){var r,s=e.variables,c=s.appHandler,u=a(s,ge),l=v.current.user.subscribe({query:Ee(e.mutation),variables:i({},u)}).subscribe({next:function(t){var n=t.provider,r=t.value;console.log("NOTIFICATION SUBS RESULTS ",c),console.log("NOTIFICATION SUBS RESULTS ",n),console.log("NOTIFICATION SUBS RESULTS ",r);var i=N.current.init.apps[e.appId];console.log("APP INDEX ARRAY ",i);var s=0;i.length>1&&(s=i.findIndex((function(e){return e===c}))),O.current[e.appId][s](r.data)},error:function(t){console.warn(t),O.current[e.appId][0]({error:t})}});console.log("SUBS HANDLER ",l),null!==(r=y.current)&&void 0!==r&&r[e.appId]?y.current[e.appId][c]=l:y.current[e.appId]=o({},c,l),t(!0)}))},_=function(e){var t,n;if(console.log("MUTATION OPTS ",e),null!==(t=O.current)&&void 0!==t&&t.sandbox){var r=Object.assign({},e);O.current.sandbox[0](o({},r.name,r))}return null!==(n=O.current)&&void 0!==n&&n.sandbox&&O.current.sandbox[0]({mutationRequest:{appID:e.appId,variables:e.variables}}),new Promise((function(t,n){e.name.split("/"),v.current.user.mutate({mutation:Ee(e.mutation),variables:{input:i(i({},e.variables),{},{dataconnector:e.name,userId:A.uuid,appId:e.appId,execId:d(),stage:N.current.init.stage})}}).then((function(e){var n,r,i;console.log("MUTATION RES ",e);var s,a=Object.keys(e.data)[0];console.log("KEY ",a),s=null!==(n=e.data[a])&&void 0!==n&&n.result&&null!==(r=e.data[a].result)&&void 0!==r&&r.result?JSON.parse(e.data[a].result.result):e.data[a],null!==(i=O.current)&&void 0!==i&&i.sandbox&&O.current.sandbox[0]({mutationResult:{data:o({},a,s)}}),t({data:o({},a,s)})})).catch((function(e){console.log("MUTATION ERROR ",e),n(e)}))}))},D=function(e){var t,n;if(console.log("OPTS ",e),null!==(t=O.current)&&void 0!==t&&t.sandbox){var r=null!=e&&e.filter?p(e.filter):"",i=Object.assign({},e);i.filter=r,O.current.sandbox[0](o({},i.name,i))}e.name.split("/");var s=[];if(e.fields&&e.fieldsList){s=e.fields.split(","),console.log(s,e.fieldsList);var a,c="";if(s.some((function(t){return c=t,-1===e.fieldsList.indexOf(t)})))return null!==(a=O.current)&&void 0!==a&&a.sandbox&&O.current.sandbox[0]({fieldsError:{fieldsList:e.fieldsList,invalidField:c}}),Promise.reject("INVALID_FIELD ("+c+")")}return null!==(n=O.current)&&void 0!==n&&n.sandbox&&O.current.sandbox[0]({queryRequest:{appID:e.appId,fields:s,filter:null!=e&&e.filter?ve(e.filter):"",next:e.next}}),new Promise((function(t,n){v.current.user.query({query:Ee(e.query),variables:{input:{dataconnector:e.name,userId:A.uuid,fields:s,filter:null!=e&&e.filter?ve(e.filter):"",next:e.next,appId:e.appId,execId:d(),stage:N.current.init.stage}}}).then((function(e){var n;if(console.log("RES ",e),null!==(n=e.data)&&void 0!==n&&n.getDataObject){var r,i=JSON.parse(e.data.getDataObject.result);null!==(r=O.current)&&void 0!==r&&r.sandbox&&O.current.sandbox[0]({queryResult:{data:{getDataObject:i}}}),t({data:{getDataObject:i}})}else{var s;console.log("NOT S3 DATA OBJECT");var a=Object.keys(e.data)[0],c=JSON.parse(e.data[a].result);null!==(s=O.current)&&void 0!==s&&s.sandbox&&O.current.sandbox[0]({queryResult:{data:o({},a,c)}}),t({data:o({},a,c)})}})).catch((function(e){var t;null!==(t=O.current)&&void 0!==t&&t.sandbox&&O.current.sandbox[0]({queryError:JSON.stringify(e)}),console.log("QUERY ERROR ",e),n(e)}))}))},k=(0,u.useCallback)((function(e,t){t.length>0&&(b.current[e]={},t.forEach((function(t,n){var r,i=t.getModuleName(),o=t.getInfo();null!==(r=O.current)&&void 0!==r&&r.sandbox&&O.current.sandbox[0]({registerConnector:i});var a={};console.log("LIST ",s(o),o),o.forEach((function(n){if(console.log("REGISTER new ",n),n.startsWith("query"))a[n]=function(r){var s,o=r.fields,a=r.filter,c=r.next;console.log("INIT ",N.current.init);var u=N.current.init.stage,l=[];return void 0!==t.getFields&&(l=t.getFields(n)),null!==(s=O.current)&&void 0!==s&&s.sandbox&&O.current.sandbox[0]({connector:i+"/"+n}),t[n]({stage:u,appID:e,name:i+"/"+n,createQuery:D,fields:o,filter:a,next:c,fieldsList:l,uuid:A.uuid})};else if(n.startsWith("subscribe"))a[n]=function(r){var s,o=r.variables;console.log("INIT MUTATION",N.current.init);var a=N.current.init.stage;return null!==(s=O.current)&&void 0!==s&&s.sandbox&&O.current.sandbox[0]({connector:i+"/"+n}),t[n]({stage:a,appID:e,name:i+"/"+n,createSubscription:S,uuid:A.uuid,variables:o})};else{if(!n.startsWith("mutation"))throw new Error("Oh no!");a[n]=function(r){var s,o=r.variables;console.log("INIT MUTATION",N.current.init);var a=N.current.init.stage;return null!==(s=O.current)&&void 0!==s&&s.sandbox&&O.current.sandbox[0]({connector:i+"/"+n}),t[n]({stage:a,appID:e,name:i+"/"+n,createMutation:_,uuid:A.uuid,callbacks:w,variables:o})}}})),b.current[e][i]=a})))}),[]),C=(0,u.useCallback)((function(e){v.current.user=e[0],v.current.prifina=e[1],v.current.s3=e[2]}),[]),R=(0,u.useCallback)((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"WIDGET";if(console.log("UPDATE SET ",e,O),"string"!=typeof e)throw new Error("onUpdate, appID is not string");var i=d();if(O.current){var s,o,a;if(null!==(s=N.current.init.apps)&&void 0!==s&&s[e]?N.current.init.apps[e].push(i):N.current.init.apps[e]=[i],null!==(o=N.current.init.users)&&void 0!==o&&o[A.uuid]&&(N.current.init.users[A.uuid]=""),N.current.init.users[A.uuid]=r,0===Object.keys(O.current).length&&(O.current={}),null!==(a=O.current)&&void 0!==a&&a[e])O.current[e].push(t);else if("WIDGET"===n){var c;null!==(c=O.current)&&void 0!==c&&c[e]||(O.current[e]=[]),O.current[e].push(t)}else O.current[e]=t;return console.log("UPDATE SET ",O.current),i}}),[]),L=(0,u.useCallback)((function(){return y.current}),[]),w=(0,u.useCallback)((function(){return O.current}),[]),F=(0,u.useCallback)((function(){return O.current={},!0}),[]),P=(0,u.useCallback)((function(e,t){return O.current[e].length>1?O.current[e].splice(t,1):delete O.current[e],!0}),[]),U=(0,u.useCallback)((function(){return b.current}),[]),M=(0,u.useCallback)((function(){var e=JSON.parse(localStorage.getItem("PrifinaAppLocalization"));return null===e&&(e={calendar:"gregory",country:"FI",day:"2-digit",desktop:!0,language:"en-US,en;q=0.9",locale:"en-GB",mobile:!1,month:"2-digit",numberingSystem:"latn",smarttv:!1,tablet:!1,timeZone:"Europe/Helsinki",timeZoneOffset:-120,year:"numeric"}),e}),[]);return N.current={stage:T,check:x,onUpdate:R,getAppSubscriptions:L,getCallbacks:w,removeCallbacks:F,deleteCallback:P,currentUser:A,getLocalization:M,registerClient:C,registerDataConnector:k,API:b.current},void 0===N.current.init&&(N.current.init={stage:T,apps:{},users:{}}),m?l().createElement(f.Provider,{value:N},m):null},Se=function(){var e=(0,u.useContext)(Ae);return(0,u.useMemo)((function(){return e.current}),[e])}}}]);